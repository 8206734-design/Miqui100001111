<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Cubo del Amor ‚ù§Ô∏è</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Montserrat:wght@300;500;700&display=swap');

        /* RESET */
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; user-select: none; }
        body {
            background: #000; color: white; font-family: 'Montserrat', sans-serif;
            height: 100vh; width: 100vw; display: flex; flex-direction: column; 
            justify-content: center; align-items: center; overflow: hidden; perspective: 1200px;
        }

        canvas { position: fixed; inset: 0; z-index: -1; pointer-events: none; }

        #love-message {
            position: fixed; top: 40px; font-family: 'Dancing Script', cursive;
            font-size: 2.8rem; color: #ff0077; text-shadow: 0 0 20px #ff0077;
            animation: pulse 2s infinite; display: none; z-index: 10; width: 100%; text-align: center;
        }
        @keyframes pulse { 0%, 100% { transform: scale(1); opacity: 0.9; } 50% { transform: scale(1.05); opacity: 1; text-shadow: 0 0 30px #ff0077; } }

        /* FORMULARIO */
        #setup-form {
            z-index: 1000; background: rgba(15, 15, 15, 0.95); padding: 30px; border-radius: 25px;
            border: 1px solid #ff0077; text-align: center; width: 90%; max-width: 400px;
            box-shadow: 0 0 50px rgba(255, 0, 119, 0.2); backdrop-filter: blur(10px);
            position: absolute;
        }
        .section-title { font-size: 0.8rem; margin-top: 15px; color: #aaa; text-transform: uppercase; letter-spacing: 2px; }
        .upload-box {
            display: flex; align-items: center; justify-content: center;
            background: rgba(255, 255, 255, 0.05); border: 2px dashed #ff0077;
            padding: 15px; border-radius: 12px; cursor: pointer; margin: 10px 0; transition: 0.3s;
        }
        .upload-box.done { border-style: solid; background: rgba(0, 255, 100, 0.1); border-color: #00ff66; }
        input[type="file"] { display: none; }
        .btn {
            background: linear-gradient(45deg, #ff0077, #ff5500); color: white; border: none; padding: 15px; margin-top: 20px;
            border-radius: 50px; font-weight: bold; cursor: pointer; width: 100%;
            box-shadow: 0 5px 20px rgba(255, 0, 119, 0.4); opacity: 0.5; pointer-events: none; transition: 0.3s;
        }

        /* CUBO 3D */
        #escena { display: none; width: 260px; height: 260px; margin: 0; }
        #cubo { width: 100%; height: 100%; position: relative; transform-style: preserve-3d; transform: rotateX(-15deg) rotateY(15deg); }
        .cara {
            position: absolute; width: 260px; height: 260px;
            border: 2px solid rgba(255, 0, 119, 0.6); box-shadow: 0 0 15px rgba(255,0,119,0.2);
            background: #000; display: flex; justify-content: center; align-items: center; overflow: hidden;
        }
        .cara img { width: 100%; height: 100%; object-fit: cover; pointer-events: none; }
        .f { transform: rotateY(0deg) translateZ(130px); } .b { transform: rotateY(180deg) translateZ(130px); }
        .r { transform: rotateY(90deg) translateZ(130px); } .l { transform: rotateY(-90deg) translateZ(130px); }
        .u { transform: rotateX(90deg) translateZ(130px); } .d { transform: rotateX(-90deg) translateZ(130px); }

        /* --- REPRODUCTOR CON LUZ VIAJERA --- */
        #player {
            display: none; position: fixed; 
            bottom: 80px; width: 95%; max-width: 450px;
            padding: 3px; /* Espacio para el borde de luz */
            border-radius: 25px; 
            overflow: hidden; /* IMPORTANTE: Recorta la luz */
            z-index: 100;
            box-shadow: 0 10px 40px rgba(0,0,0,0.6);
        }

        /* La Luz Giratoria */
        #player::before {
            content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
            background: conic-gradient(transparent, transparent, transparent, #ff0077);
            animation: rotate-border 4s linear infinite;
            z-index: 1;
        }
        @keyframes rotate-border { 100% { transform: rotate(360deg); } }

        /* El fondo real del player (tapa el centro de la luz) */
        .player-inner {
            background: rgba(10, 10, 10, 0.9); backdrop-filter: blur(20px);
            width: 100%; height: 100%; border-radius: 23px;
            display: flex; align-items: center; gap: 15px; padding: 12px 20px;
            position: relative; z-index: 2; /* Encima de la luz */
        }

        .vinyl {
            width: 50px; height: 50px; flex-shrink: 0;
            border-radius: 50%; border: 2px solid #333; 
            overflow: hidden; box-shadow: 0 0 10px rgba(255,255,255,0.1);
            position: relative; background: #000;
        }
        .vinyl img { width: 100%; height: 100%; object-fit: cover; display: block; }
        .vinyl.spinning { animation: spin 4s linear infinite; border-color: #ff0077; box-shadow: 0 0 15px #ff0077; }
        @keyframes spin { 100% { transform: rotate(360deg); } }

        #play-btn {
            background: white; color: #ff0077; border: none; width: 45px; height: 45px; flex-shrink: 0;
            border-radius: 50%; font-size: 1.4rem; cursor: pointer; display: flex; justify-content: center; align-items: center;
            box-shadow: 0 0 20px rgba(255,255,255,0.4); transition: 0.2s; padding-left: 4px;
        }
        #play-btn.playing { padding-left: 0; box-shadow: 0 0 25px #ff0077; background: #ff0077; color: white; }
        
        .track-info { flex-grow: 1; display: flex; flex-direction: column; gap: 6px; }
        .progress-area { width: 100%; height: 6px; background: rgba(255,255,255,0.1); border-radius: 10px; cursor: pointer; position: relative; }
        .progress-bar { height: 100%; width: 0%; background: linear-gradient(90deg, #ff0077, #ff9900); border-radius: 10px; position: relative; box-shadow: 0 0 15px #ff0077; }
        .progress-bar::after { content: ''; position: absolute; right: -6px; top: -4px; width: 14px; height: 14px; background: white; border-radius: 50%; box-shadow: 0 0 10px rgba(255,255,255,0.9); transform: scale(0); transition: transform 0.2s; }
        .progress-area:hover .progress-bar::after { transform: scale(1); }
        .time-display { font-size: 0.7rem; color: #aaa; font-weight: 600; display: flex; justify-content: space-between; letter-spacing: 1px; }

        .visualizer { display: flex; gap: 3px; height: 20px; align-items: flex-end; }
        .bar { width: 4px; background: #ff0077; border-radius: 2px; height: 3px; transition: 0.1s; }
        .playing .bar { animation: bounce 0.5s infinite ease-in-out alternate; }
        .bar:nth-child(2) { animation-delay: 0.1s; } .bar:nth-child(3) { animation-delay: 0.2s; }
        @keyframes bounce { 0% { height: 3px; opacity: 0.5; } 100% { height: 20px; opacity: 1; box-shadow: 0 0 10px #ff0077; } }

        #btn-download {
            display: none; position: fixed; 
            bottom: 160px; /* Arriba del player */
            background: rgba(0,0,0,0.6); color: #fff; border: 1px solid rgba(255,255,255,0.2);
            padding: 10px 25px; border-radius: 50px; font-size: 0.75rem; font-weight: 600;
            cursor: pointer; z-index: 1001; backdrop-filter: blur(5px); transition: 0.3s;
        }
        #btn-download:hover { background: #ff0077; border-color: #ff0077; }
    </style>
</head>
<body>

    <canvas id="cv"></canvas>
    <div id="love-message">Te amo Cris ‚ù§Ô∏è</div>

    <div id="setup-form">
        <h2 style="color: #ff0077; margin-bottom:10px;">Creador de Regalos</h2>
        <div class="section-title">1. Escoge 6 foticos de nosotros.</div>
        <label class="upload-box" id="box-img" for="file-input"><span id="status-img">üìÅ Abrir Galer√≠a</span><input type="file" id="file-input" accept="image/*" multiple></label>
        <div class="section-title">2. Escoge una cancion.</div>
        <label class="upload-box" id="box-audio" for="audio-input"><span id="status-audio">üéµ Cargar MP3</span><input type="file" id="audio-input" accept="audio/*"></label>
        <button id="start-btn" class="btn">‚ú® CREAR MAGIA ‚ú®</button>
    </div>

    <div id="escena">
        <div id="cubo">
            <div class="cara f"><img id="img0"></div><div class="cara b"><img id="img1"></div>
            <div class="cara r"><img id="img2"></div><div class="cara l"><img id="img3"></div>
            <div class="cara u"><img id="img4"></div><div class="cara d"><img id="img5"></div>
        </div>
    </div>

    <audio id="audio-element" loop></audio>
    
    <div id="player">
        <div class="player-inner">
            <div class="vinyl" id="vinyl"><img id="vinyl-img" alt="cover"></div>
            <button id="play-btn">‚ñ∂</button>
            <div class="track-info">
                <div class="progress-area" id="progress-area"><div class="progress-bar" id="progress-bar"></div></div>
                <div class="time-display"><span id="curr-time">0:00</span><span id="dur-time">0:00</span></div>
            </div>
            <div class="visualizer" id="visualizer"><div class="bar"></div><div class="bar"></div><div class="bar"></div></div>
        </div>
    </div>

    <button id="btn-download">üíæ GUARDAR HTML FINAL</button>

    <script>
        const canvas = document.getElementById('cv'), ctx = canvas.getContext('2d');
        const cubo = document.getElementById('cubo');
        const audio = document.getElementById('audio-element');
        const playBtn = document.getElementById('play-btn');
        const progressBar = document.getElementById('progress-bar');
        const progressArea = document.getElementById('progress-area');
        const currTime = document.getElementById('curr-time');
        const durTime = document.getElementById('dur-time');
        const vinyl = document.getElementById('vinyl');
        const vinylImg = document.getElementById('vinyl-img');
        const visualizer = document.getElementById('visualizer');

        let compressedImages = [], audioBase64 = "", particles = [];
        let isDragging = false, rotX = -15, rotY = 15, lastX, lastY, vx = 0;
        let imgReady = false, audReady = false;

        // --- PART√çCULAS ---
        function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
        window.addEventListener('resize', resize); resize();
        class Particle {
            constructor() { this.init(); this.y = Math.random() * canvas.height; }
            init() { this.x = Math.random() * canvas.width; this.y = canvas.height + 50; this.s = Math.random() * 15 + 10; this.v = Math.random() * 1.5 + 0.5; this.t = Math.random() > 0.5 ? '‚ù§Ô∏è' : 'üå∏'; this.o = Math.random() * 0.5 + 0.1; }
            draw() {
                this.x += vx * 0.4; this.y -= this.v; 
                if(this.y < -50 || this.x < -50 || this.x > canvas.width + 50) this.init();
                ctx.globalAlpha = this.o; ctx.font = `${this.s}px serif`; ctx.fillText(this.t, this.x, this.y);
            }
        }
        for(let i=0; i<100; i++) particles.push(new Particle());

        function loop() {
            ctx.clearRect(0,0,canvas.width, canvas.height);
            particles.forEach(p => p.draw());
            if (!isDragging && document.getElementById('escena').style.display === 'block') { rotY += 0.2; vx *= 0.95; }
            if (document.getElementById('escena').style.display === 'block') cubo.style.transform = `rotateX(${rotX}deg) rotateY(${rotY}deg)`;
            
            if(!audio.paused && audio.duration) {
                const pct = (audio.currentTime / audio.duration) * 100;
                progressBar.style.width = `${pct}%`;
                currTime.innerText = formatTime(audio.currentTime);
            }
            requestAnimationFrame(loop);
        }
        loop();

        // --- AUDIO UI ---
        function formatTime(s) { const m = Math.floor(s/60), se = Math.floor(s%60); return m+":"+(se<10?'0'+se:se); }
        function togglePlay() {
            if(audio.paused) { audio.play(); playBtn.innerHTML = "‚è∏"; playBtn.classList.add('playing'); vinyl.classList.add('spinning'); visualizer.classList.add('playing'); }
            else { audio.pause(); playBtn.innerHTML = "‚ñ∂"; playBtn.classList.remove('playing'); vinyl.classList.remove('spinning'); visualizer.classList.remove('playing'); }
        }
        playBtn.addEventListener('click', togglePlay);
        progressArea.addEventListener('click', (e) => { const w = progressArea.clientWidth; const cx = e.offsetX; const d = audio.duration; audio.currentTime = (cx / w) * d; });
        audio.addEventListener('loadedmetadata', () => durTime.innerText = formatTime(audio.duration));
        audio.addEventListener('ended', () => { playBtn.innerHTML = "‚ñ∂"; playBtn.classList.remove('playing'); vinyl.classList.remove('spinning'); visualizer.classList.remove('playing'); });

        // --- ARCHIVOS ---
        function check() { if(imgReady && audReady) { const b = document.getElementById('start-btn'); b.style.opacity="1"; b.style.pointerEvents="all"; } }
        document.getElementById('file-input').addEventListener('change', async (e) => {
            if(e.target.files.length !== 6) return alert("Selecciona 6 fotos");
            document.getElementById('status-img').innerText = "Procesando...";
            compressedImages = [];
            for(let f of e.target.files) compressedImages.push(await compress(f));
            document.getElementById('status-img').innerText = "¬°Fotos Listas!"; document.getElementById('box-img').classList.add('done'); imgReady = true; check();
        });
        document.getElementById('audio-input').addEventListener('change', (e) => {
            const f = e.target.files[0]; if(!f) return;
            document.getElementById('status-audio').innerText = "Codificando...";
            const r = new FileReader(); r.readAsDataURL(f);
            r.onload = (ev) => { audioBase64 = ev.target.result; document.getElementById('status-audio').innerText = "¬°M√∫sica Lista!"; document.getElementById('box-audio').classList.add('done'); audReady = true; check(); };
        });
        function compress(file) {
            return new Promise((res) => {
                const r = new FileReader(); r.readAsDataURL(file);
                r.onload = (e) => {
                    const i = new Image(); i.src = e.target.result;
                    i.onload = () => { const c = document.createElement('canvas'); c.width = 500; c.height = 500; const x = c.getContext('2d'); const s = Math.max(500/i.width, 500/i.height); x.drawImage(i, (500-i.width*s)/2, (500-i.height*s)/2, i.width*s, i.height*s); res(c.toDataURL('image/jpeg', 0.7)); }
                }
            });
        }

        document.getElementById('start-btn').addEventListener('click', () => {
            compressedImages.forEach((s, i) => document.getElementById(`img${i}`).src = s);
            vinylImg.src = compressedImages[0];
            audio.src = audioBase64;
            document.getElementById('setup-form').style.display = "none";
            document.getElementById('escena').style.display = "block";
            document.getElementById('btn-download').style.display = "block";
            document.getElementById('love-message').style.display = "block";
            document.getElementById('player').style.display = "block"; // Changed from flex to block for the structure
            togglePlay(); 
        });

        // --- INTERACCI√ìN 3D ---
        const start = (e) => { isDragging = true; lastX = e.pageX || e.touches[0].pageX; lastY = e.pageY || e.touches[0].pageY; };
        const end = () => { isDragging = false; };
        const move = (e) => { if (!isDragging) return; const x = e.pageX || e.touches[0].pageX; const y = e.pageY || e.touches[0].pageY; vx = x - lastX; rotY += vx * 0.5; rotX -= (y - lastY) * 0.5; lastX = x; lastY = y; };
        window.addEventListener('mousedown', start); window.addEventListener('touchstart', start);
        window.addEventListener('mousemove', move); window.addEventListener('touchmove', move);
        window.addEventListener('mouseup', end); window.addEventListener('touchend', end);

        // --- DESCARGA CON LUZ VIAJERA ---
        document.getElementById('btn-download').addEventListener('click', () => {
            const template = `<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Para Ti Mi Amor</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Montserrat:wght@300;500;700&display=swap');
        *{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;user-select:none}
        body{background:#000;color:white;font-family:'Montserrat',sans-serif;height:100vh;width:100vw;display:flex;flex-direction:column;justify-content:center;align-items:center;overflow:hidden;perspective:1200px}
        canvas{position:fixed;inset:0;z-index:-1}
        #msg{position:fixed;top:40px;font-family:'Dancing Script',cursive;font-size:2.8rem;color:#ff0077;text-shadow:0 0 20px #ff0077;animation:p 2s infinite;z-index:10;width:100%;text-align:center;}
        @keyframes p{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
        #escena{width:260px;height:260px;margin:0}
        #cubo{width:100%;height:100%;position:relative;transform-style:preserve-3d}
        .cara{position:absolute;width:260px;height:260px;border:2px solid rgba(255,0,119,0.6);box-shadow:0 0 15px rgba(255,0,119,0.2);background:#000;display:flex;justify-content:center;align-items:center;overflow:hidden}
        .cara img{width:100%;height:100%;object-fit:cover;pointer-events:none}
        .f{transform:rotateY(0deg) translateZ(130px)}.b{transform:rotateY(180deg) translateZ(130px)}.r{transform:rotateY(90deg) translateZ(130px)}.l{transform:rotateY(-90deg) translateZ(130px)}.u{transform:rotateX(90deg) translateZ(130px)}.d{transform:rotateX(-90deg) translateZ(130px)}
        
        /* PLAYER STYLES */
        #pl{display:block;position:fixed;bottom:80px;width:95%;max-width:450px;padding:3px;border-radius:25px;overflow:hidden;z-index:100;box-shadow:0 10px 40px rgba(0,0,0,0.6)}
        #pl::before{content:'';position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:conic-gradient(transparent,transparent,transparent,#ff0077);animation:rb 4s linear infinite;z-index:1}
        @keyframes rb{100%{transform:rotate(360deg)}}
        .pi{background:rgba(10,10,10,0.9);backdrop-filter:blur(20px);width:100%;height:100%;border-radius:23px;display:flex;align-items:center;gap:15px;padding:12px 20px;position:relative;z-index:2}
        
        .vin{width:50px;height:50px;flex-shrink:0;border-radius:50%;border:3px solid #222;overflow:hidden;position:relative;box-shadow:0 0 10px rgba(255,255,255,0.1);background:#000}
        .vin img{width:100%;height:100%;object-fit:cover}
        .vin.sp{animation:sp 4s linear infinite;border-color:#ff0077;box-shadow:0 0 15px #ff0077}@keyframes sp{100%{transform:rotate(360deg)}}
        #pb{background:white;color:#ff0077;border:none;width:45px;height:45px;flex-shrink:0;border-radius:50%;font-size:1.4rem;cursor:pointer;display:flex;justify-content:center;align-items:center;box-shadow:0 0 20px rgba(255,255,255,0.4);transition:0.2s;padding-left:4px}
        #pb.pg{padding-left:0;box-shadow:0 0 25px #ff0077;background:#ff0077;color:white}
        .ti{flex-grow:1;display:flex;flex-direction:column;gap:6px}
        .pa{width:100%;height:6px;background:rgba(255,255,255,0.1);border-radius:10px;cursor:pointer;position:relative}
        .bar{height:100%;width:0%;background:linear-gradient(90deg,#ff0077,#ff9900);border-radius:10px;position:relative;box-shadow:0 0 15px #ff0077}
        .bar::after{content:'';position:absolute;right:-6px;top:-4px;width:14px;height:14px;background:white;border-radius:50%;box-shadow:0 0 10px rgba(255,255,255,0.9);transform:scale(0);transition:transform 0.2s}
        .td{font-size:0.7rem;color:#aaa;font-weight:600;display:flex;justify-content:space-between;letter-spacing:1px}
        .vz{display:flex;gap:3px;height:20px;align-items:flex-end}
        .vzb{width:4px;background:#ff0077;border-radius:2px;height:3px;transition:0.1s}
        .vz.pg .vzb{animation:bn 0.5s infinite ease-in-out alternate}
        .vzb:nth-child(2){animation-delay:0.1s}.vzb:nth-child(3){animation-delay:0.2s}
        @keyframes bn{0%{height:3px;opacity:0.5}100%{height:20px;opacity:1;box-shadow:0 0 10px #ff0077}}
    </style>
</head>
<body>
    <canvas id="cv"></canvas><div id="msg">Te amo Cris ‚ù§Ô∏è</div>
    <div id="escena"><div id="cubo">
        <div class="cara f"><img src="${compressedImages[0]}"></div><div class="cara b"><img src="${compressedImages[1]}"></div><div class="cara r"><img src="${compressedImages[2]}"></div><div class="cara l"><img src="${compressedImages[3]}"></div><div class="cara u"><img src="${compressedImages[4]}"></div><div class="cara d"><img src="${compressedImages[5]}"></div>
    </div></div>
    <audio id="au" loop src="${audioBase64}"></audio>
    <div id="pl">
        <div class="pi">
            <div class="vin" id="vin"><img src="${compressedImages[0]}"></div>
            <button id="pb">‚ñ∂</button>
            <div class="ti"><div class="pa" id="pa"><div class="bar" id="bar"></div></div><div class="td"><span id="ct">0:00</span><span id="dt">0:00</span></div></div>
            <div class="vz" id="vz"><div class="vzb"></div><div class="vzb"></div><div class="vzb"></div></div>
        </div>
    </div>
    <script>
        const c=document.getElementById('cv'),x=c.getContext('2d'),cb=document.getElementById('cubo'),au=document.getElementById('au'),pb=document.getElementById('pb'),bar=document.getElementById('bar'),pa=document.getElementById('pa'),ct=document.getElementById('ct'),dt=document.getElementById('dt'),vin=document.getElementById('vin'),vz=document.getElementById('vz');
        let ps=[],id=false,rx=-15,ry=15,lx,ly,vx=0;
        function rs(){c.width=window.innerWidth;c.height=window.innerHeight}window.addEventListener('resize',rs);rs();
        class P{constructor(){this.i();this.y=Math.random()*c.height}i(){this.x=Math.random()*c.width;this.y=c.height+50;this.s=Math.random()*15+10;this.v=Math.random()*1.5+0.5;this.t=Math.random()>0.5?'‚ù§Ô∏è':'üå∏';this.o=Math.random()*0.5+0.1}d(){this.x+=vx*0.4;this.y-=this.v;if(this.y<-50||this.x<-50||this.x>c.width+50)this.i();x.globalAlpha=this.o;x.font=this.s+"px serif";x.fillText(this.t,this.x,this.y)}}for(let i=0;i<100;i++)ps.push(new P());
        function fmt(s){const m=Math.floor(s/60),se=Math.floor(s%60);return m+":"+(se<10?'0'+se:se)}
        function an(){
            x.clearRect(0,0,c.width,c.height);ps.forEach(p=>p.d());
            if(!id){ry+=0.2;vx*=0.95} cb.style.transform="rotateX("+rx+"deg) rotateY("+ry+"deg)";
            if(!au.paused){bar.style.width=(au.currentTime/au.duration)*100+"%";ct.innerText=fmt(au.currentTime)}
            requestAnimationFrame(an)
        }
        au.addEventListener('loadedmetadata',()=>dt.innerText=fmt(au.duration));
        function tgl(){if(au.paused){au.play();pb.innerText="‚è∏";pb.classList.add('pg');vin.classList.add('sp');vz.classList.add('pg')}else{au.pause();pb.innerText="‚ñ∂";pb.classList.remove('pg');vin.classList.remove('sp');vz.classList.remove('pg')}}
        pb.addEventListener('click',tgl);
        pa.addEventListener('click',(e)=>{const w=pa.clientWidth,ck=e.offsetX,d=au.duration;au.currentTime=(ck/w)*d});
        const st=(e)=>{id=true;lx=e.pageX||e.touches[0].pageX;ly=e.pageY||e.touches[0].pageY};const en=()=>{id=false};const mv=(e)=>{if(!id)return;let nx=e.pageX||e.touches[0].pageX,ny=e.pageY||e.touches[0].pageY;vx=nx-lx;ry+=vx*0.5;rx-=(ny-ly)*0.5;lx=nx;ly=ny};
        window.addEventListener('mousedown',st);window.addEventListener('touchstart',st);window.addEventListener('mousemove',mv);window.addEventListener('touchmove',mv);window.addEventListener('mouseup',en);window.addEventListener('touchend',en);an();
    <\/script>
</body>
</html>`;
            const blob = new Blob([template], { type: 'text/html' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = "Cubo de Amor.html";
            link.click();
        });
    </script>
</body>
</html>